

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>locopy.snowflake module &mdash; locopy 0.3.4 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="locopy.utility module" href="locopy.utility.html" />
    <link rel="prev" title="locopy.s3 module" href="locopy.s3.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> locopy
          

          
          </a>

          
            
            
              <div class="version">
                0.3.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Basic Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes.html">Common Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../snowflake.html">Snowflake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql_injection.html">SQL Injection</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="locopy.html">locopy package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="locopy.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="locopy.database.html">locopy.database module</a></li>
<li class="toctree-l4"><a class="reference internal" href="locopy.errors.html">locopy.errors module</a></li>
<li class="toctree-l4"><a class="reference internal" href="locopy.logger.html">locopy.logger module</a></li>
<li class="toctree-l4"><a class="reference internal" href="locopy.redshift.html">locopy.redshift module</a></li>
<li class="toctree-l4"><a class="reference internal" href="locopy.s3.html">locopy.s3 module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">locopy.snowflake module</a></li>
<li class="toctree-l4"><a class="reference internal" href="locopy.utility.html">locopy.utility module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="locopy.html#module-locopy">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">locopy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">locopy</a> &raquo;</li>
        
          <li><a href="locopy.html">locopy package</a> &raquo;</li>
        
      <li>locopy.snowflake module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/locopy.snowflake.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-locopy.snowflake">
<span id="locopy-snowflake-module"></span><h1>locopy.snowflake module<a class="headerlink" href="#module-locopy.snowflake" title="Permalink to this headline">¶</a></h1>
<p>Snowflake Module
Module to wrap a database adapter into a Snowflake class which can be used to connect
to Snowflake, and run arbitrary code.</p>
<dl class="class">
<dt id="locopy.snowflake.Snowflake">
<em class="property">class </em><code class="descclassname">locopy.snowflake.</code><code class="descname">Snowflake</code><span class="sig-paren">(</span><em>profile=None</em>, <em>kms_key=None</em>, <em>dbapi=None</em>, <em>config_yaml=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/locopy/snowflake.html#Snowflake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locopy.snowflake.Snowflake" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="locopy.s3.html#locopy.s3.S3" title="locopy.s3.S3"><code class="xref py py-class docutils literal notranslate"><span class="pre">locopy.s3.S3</span></code></a>, <a class="reference internal" href="locopy.database.html#locopy.database.Database" title="locopy.database.Database"><code class="xref py py-class docutils literal notranslate"><span class="pre">locopy.database.Database</span></code></a></p>
<p>Locopy class which manages connections to Snowflake.  Inherits <code class="docutils literal notranslate"><span class="pre">Database</span></code> and implements
the specific <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span></code> functionality.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>profile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the AWS profile to use which is typically stored in the
<code class="docutils literal notranslate"><span class="pre">credentials</span></code> file.  You can also set environment variable
<code class="docutils literal notranslate"><span class="pre">AWS_DEFAULT_PROFILE</span></code> which would be used instead.</li>
<li><strong>kms_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The KMS key to use for encryption
If kms_key Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> then the AES256 ServerSideEncryption
will be used.</li>
<li><strong>dbapi</strong> (<em>DBAPI 2 module</em><em>, </em><em>optional</em>) – A database adapter which is Python DB API 2.0 compliant (<code class="docutils literal notranslate"><span class="pre">snowflake.connector</span></code>)</li>
<li><strong>config_yaml</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – String representing the YAML file location of the database connection keyword arguments. It
is worth noting that this should only contain valid arguments for the database connector you
plan on using. It will throw an exception if something is passed through which isn’t valid.</li>
<li><strong>**kwargs</strong> – Database connection keyword arguments.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="locopy.snowflake.Snowflake.profile">
<code class="descname">profile</code><a class="headerlink" href="#locopy.snowflake.Snowflake.profile" title="Permalink to this definition">¶</a></dt>
<dd><p>String representing the AWS profile for authentication</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="locopy.snowflake.Snowflake.kms_key">
<code class="descname">kms_key</code><a class="headerlink" href="#locopy.snowflake.Snowflake.kms_key" title="Permalink to this definition">¶</a></dt>
<dd><p>String representing the s3 kms key</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="locopy.snowflake.Snowflake.session">
<code class="descname">session</code><a class="headerlink" href="#locopy.snowflake.Snowflake.session" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold the AWS session credentials / info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">boto3.Session</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="locopy.snowflake.Snowflake.s3">
<code class="descname">s3</code><a class="headerlink" href="#locopy.snowflake.Snowflake.s3" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold the S3 client object which is used to upload/delete files to S3</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">botocore.client.S3</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="locopy.snowflake.Snowflake.dbapi">
<code class="descname">dbapi</code><a class="headerlink" href="#locopy.snowflake.Snowflake.dbapi" title="Permalink to this definition">¶</a></dt>
<dd><p>database adapter which is Python DBAPI 2.0 compliant (snowflake.connector)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">DBAPI 2 module</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="locopy.snowflake.Snowflake.connection">
<code class="descname">connection</code><a class="headerlink" href="#locopy.snowflake.Snowflake.connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of database connection items</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="locopy.snowflake.Snowflake.conn">
<code class="descname">conn</code><a class="headerlink" href="#locopy.snowflake.Snowflake.conn" title="Permalink to this definition">¶</a></dt>
<dd><p>DBAPI connection instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dbapi.connection</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="locopy.snowflake.Snowflake.cursor">
<code class="descname">cursor</code><a class="headerlink" href="#locopy.snowflake.Snowflake.cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>DBAPI cursor instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">dbapi.cursor</td>
</tr>
</tbody>
</table>
</dd></dl>

<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">CredentialsError</span></code> – Database credentials are not provided or valid</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">S3Error</span></code> – Error initializing AWS Session (ex: invalid profile)</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">S3CredentialsError</span></code> – Issue with AWS credentials</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">S3InitializationError</span></code> – Issue initializing S3 session</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="locopy.snowflake.Snowflake.column_names">
<code class="descname">column_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.column_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Pull column names out of the cursor description. Depending on the
DBAPI, it could return column names as bytes: <code class="docutils literal notranslate"><span class="pre">b'column_name'</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of column names, all in lower-case</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)">list</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/locopy/snowflake.html#Snowflake.connect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locopy.snowflake.Snowflake.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a connection to the Snowflake cluster by
setting the values of the <code class="docutils literal notranslate"><span class="pre">conn</span></code> and <code class="docutils literal notranslate"><span class="pre">cursor</span></code> attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DBError</span></code> – If there is a problem establishing a connection to Snowflake.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>table_name</em>, <em>stage</em>, <em>file_type='csv'</em>, <em>format_options=None</em>, <em>copy_options=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/locopy/snowflake.html#Snowflake.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locopy.snowflake.Snowflake.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span> <span class="pre">&lt;table&gt;</span></code> command to load CSV files from a stage into
a Snowflake table. If <code class="docutils literal notranslate"><span class="pre">file_type</span> <span class="pre">==</span> <span class="pre">csv</span></code> and <code class="docutils literal notranslate"><span class="pre">format_options</span> <span class="pre">==</span> <span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">format_options</span></code>
will default to: <code class="docutils literal notranslate"><span class="pre">[&quot;FIELD_DELIMITER='|'&quot;,</span> <span class="pre">&quot;SKIP_HEADER=0&quot;]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>table_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The Snowflake table name which is being loaded. Must be fully qualified:
<cite>&lt;namespace&gt;.&lt;table_name&gt;</cite></li>
<li><strong>stage</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Stage location of the load file. This can be a internal or external stage</li>
<li><strong>file_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The file type. One of <code class="docutils literal notranslate"><span class="pre">csv</span></code>, <code class="docutils literal notranslate"><span class="pre">json</span></code>, or <code class="docutils literal notranslate"><span class="pre">parquet</span></code></li>
<li><strong>format_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of strings of format options to provide to the <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span></code> command. The options
will typically be in the format of <code class="docutils literal notranslate"><span class="pre">[&quot;a=b&quot;,</span> <span class="pre">&quot;c=d&quot;]</span></code></li>
<li><strong>copy_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of strings of copy options to provide to the <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span></code> command.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DBError</span></code> – If there is a problem executing the COPY command, or a connection
has not been initalized.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.delete_from_s3">
<code class="descname">delete_from_s3</code><span class="sig-paren">(</span><em>bucket</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.delete_from_s3" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a file from an S3 bucket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bucket</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The AWS S3 bucket from which you are deleting the file.</li>
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of the S3 object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">S3DeletionError</span></code> – If there is a issue deleting from the S3 bucket</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.delete_list_from_s3">
<code class="descname">delete_list_from_s3</code><span class="sig-paren">(</span><em>s3_list</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.delete_list_from_s3" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a list of files from an S3 bucket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s3_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of strings with the s3 paths of the files to delete. The strings should not include
the <cite>s3://</cite> scheme.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.disconnect">
<code class="descname">disconnect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Terminates the connection by closing the values of the <code class="docutils literal notranslate"><span class="pre">conn</span></code> and <code class="docutils literal notranslate"><span class="pre">cursor</span></code>
attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DBError</span></code> – If there is a problem disconnecting from the database.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.download_from_internal">
<code class="descname">download_from_internal</code><span class="sig-paren">(</span><em>stage</em>, <em>local=None</em>, <em>parallel=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/locopy/snowflake.html#Snowflake.download_from_internal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locopy.snowflake.Snowflake.download_from_internal" title="Permalink to this definition">¶</a></dt>
<dd><p>Download file(s) from a internal stage via the <code class="docutils literal notranslate"><span class="pre">GET</span></code> command.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stage</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Internal stage location to load the file.</li>
<li><strong>local</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The local directory path where files will be downloaded to. Defualts to the current
working directory (<code class="docutils literal notranslate"><span class="pre">os.getcwd()</span></code>). Otherwise it must be the absolute path.</li>
<li><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Specifies the number of threads to use for downloading files.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.download_from_s3">
<code class="descname">download_from_s3</code><span class="sig-paren">(</span><em>bucket</em>, <em>key</em>, <em>local</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.download_from_s3" title="Permalink to this definition">¶</a></dt>
<dd><p>Download a file from a S3 bucket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bucket</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The AWS S3 bucket which you are copying the local file to.</li>
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The key to name the S3 object.</li>
<li><strong>local</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The local file which you wish to copy to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">S3DownloadError</span></code> – If there is a issue downloading to the S3 bucket</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.download_list_from_s3">
<code class="descname">download_list_from_s3</code><span class="sig-paren">(</span><em>s3_list</em>, <em>local_path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.download_list_from_s3" title="Permalink to this definition">¶</a></dt>
<dd><p>Download a list of files from s3.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s3_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of strings with the s3 paths of the files to download</li>
<li><strong>local_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The local path where the files will be copied to. Defualts to the current working
directory (<code class="docutils literal notranslate"><span class="pre">os.getcwd()</span></code>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Returns a list of strings of the local file names</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)">list</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>sql</em>, <em>commit=True</em>, <em>params=()</em>, <em>many=False</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute some sql against the connection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sql</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – SQL to run against the connection.  Could be one or multiple
statements.</li>
<li><strong>commit</strong> (<em>Boolean</em><em>, </em><em>default True</em>) – Whether to “commit” the commands to the cluster immediately or not.</li>
<li><strong>params</strong> (<em>iterable of parameters</em>) – Parameters to submit with the query. The exact syntax will depend
on the database adapter you are using</li>
<li><strong>many</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to execute the script as an “execute many”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">DBError</span></code> – if a problem occurs executing the <code class="docutils literal notranslate"><span class="pre">sql</span></code> statement</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">DBError</span></code> – If a connection to the database cannot be made</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.insert_dataframe_to_table">
<code class="descname">insert_dataframe_to_table</code><span class="sig-paren">(</span><em>dataframe</em>, <em>table_name</em>, <em>columns=None</em>, <em>create=False</em>, <em>metadata=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/locopy/snowflake.html#Snowflake.insert_dataframe_to_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locopy.snowflake.Snowflake.insert_dataframe_to_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a Pandas dataframe to an existing table or a new table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataframe</strong> (<em>Pandas Dataframe</em>) – The pandas dataframe which needs to be inserted.</li>
<li><strong>table_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of the Snowflake table which is being inserted.</li>
<li><strong>columns</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – The list of columns which will be uploaded.</li>
<li><strong>create</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Boolean flag if a new table need to be created and insert to.</li>
<li><strong>metadata</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – If metadata==None, it will be generated based on data</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.parse_s3_url">
<code class="descname">parse_s3_url</code><span class="sig-paren">(</span><em>s3_url</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.parse_s3_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a string of the s3 url to extract the bucket and key.
scheme or not.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s3_url</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – s3 url. The string can include the <cite>s3://</cite> scheme (which is disgarded)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>bucket</strong> (<em>str</em>) – s3 bucket</li>
<li><strong>key</strong> (<em>str</em>) – s3 key</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.to_dataframe">
<code class="descname">to_dataframe</code><span class="sig-paren">(</span><em>size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dataframe of the last query results.  This imports Pandas
in here, so that it’s not needed for other use cases.  This is just a
convenience method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Chunk size to fetch.  Defaults to None.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dataframe with lowercase column names.  Returns None if no fetched
result.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.to_dict">
<code class="descname">to_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate dictionaries of rows</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Yields:</th><td class="field-body"><em>dict</em> – Each row, encoded as a dict.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.unload">
<code class="descname">unload</code><span class="sig-paren">(</span><em>stage</em>, <em>table_name</em>, <em>file_type='csv'</em>, <em>format_options=None</em>, <em>header=False</em>, <em>copy_options=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/locopy/snowflake.html#Snowflake.unload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locopy.snowflake.Snowflake.unload" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span> <span class="pre">&lt;location&gt;</span></code> command to export a query/table from
Snowflake to a stage. If <code class="docutils literal notranslate"><span class="pre">file_type</span> <span class="pre">==</span> <span class="pre">csv</span></code> and <code class="docutils literal notranslate"><span class="pre">format_options</span> <span class="pre">==</span> <span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">format_options</span></code>
will default to: <code class="docutils literal notranslate"><span class="pre">[&quot;FIELD_DELIMITER='|'&quot;]</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stage</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Stage location (internal or external) where the data files are unloaded</li>
<li><strong>table_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The Snowflake table name which is being unloaded. Must be fully qualified:
<code class="docutils literal notranslate"><span class="pre">&lt;namespace&gt;.&lt;table_name&gt;</span></code></li>
<li><strong>file_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The file type. One of <code class="docutils literal notranslate"><span class="pre">csv</span></code>, <code class="docutils literal notranslate"><span class="pre">json</span></code>, or <code class="docutils literal notranslate"><span class="pre">parquet</span></code></li>
<li><strong>format_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of strings of format options to provide to the <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span></code> command.</li>
<li><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Boolean flag if header is included in the file(s)</li>
<li><strong>copy_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of strings of copy options to provide to the <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">INTO</span></code> command.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DBError</span></code> – If there is a problem executing the UNLOAD command, or a connection
has not been initalized.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.upload_list_to_s3">
<code class="descname">upload_list_to_s3</code><span class="sig-paren">(</span><em>local_list</em>, <em>bucket</em>, <em>folder=None</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.upload_list_to_s3" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload a list of files to a S3 bucket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of strings with the file paths of the files to upload</li>
<li><strong>bucket</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The AWS S3 bucket which you are copying the local file to.</li>
<li><strong>folder</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The AWS S3 folder of the bucket which you are copying the local
files to. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>. Please note that you must follow the
<code class="docutils literal notranslate"><span class="pre">/</span></code> convention when using subfolders.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Returns a list of the generated S3 bucket and keys of the files which were uploaded. The
<code class="docutils literal notranslate"><span class="pre">S3://</span></code> part is NOT include. The output would look like the following:
<code class="docutils literal notranslate"><span class="pre">[&quot;my-bucket/key1&quot;,</span> <span class="pre">&quot;my-bucket/key2&quot;,</span> <span class="pre">...]</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)">list</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>There is a assumption that if you are loading multiple files (via <cite>splits</cite>) it follows a
structure such as <cite>file_name.extension.#</cite> (<cite>#</cite> splits). It allows for the <cite>COPY</cite> statement
to use the key prefix vs specificing an exact file name. The returned list helps with this
process downstream.</p>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.upload_to_internal">
<code class="descname">upload_to_internal</code><span class="sig-paren">(</span><em>local</em>, <em>stage</em>, <em>parallel=4</em>, <em>auto_compress=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/locopy/snowflake.html#Snowflake.upload_to_internal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locopy.snowflake.Snowflake.upload_to_internal" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload file(s) to a internal stage via the <code class="docutils literal notranslate"><span class="pre">PUT</span></code> command.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>local</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The local directory path to the file to upload. Wildcard characters (<code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">?</span></code>) are
supported to enable uploading multiple files in a directory. Otherwise it must be the
absolute path.</li>
<li><strong>stage</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Internal stage location to load the file.</li>
<li><strong>parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Specifies the number of threads to use for uploading files.</li>
<li><strong>auto_compress</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Specifies if Snowflake uses gzip to compress files during upload.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the files are compressed (if they are not already compressed).
if <code class="docutils literal notranslate"><span class="pre">False</span></code>, the files are uploaded as-is.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="locopy.snowflake.Snowflake.upload_to_s3">
<code class="descname">upload_to_s3</code><span class="sig-paren">(</span><em>local</em>, <em>bucket</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#locopy.snowflake.Snowflake.upload_to_s3" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload a file to a S3 bucket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>local</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The local file which you wish to copy.</li>
<li><strong>bucket</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The AWS S3 bucket which you are copying the local file to.</li>
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The key to name the S3 object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">S3UploadError</span></code> – If there is a issue uploading to the S3 bucket</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="locopy.snowflake.combine_options">
<code class="descclassname">locopy.snowflake.</code><code class="descname">combine_options</code><span class="sig-paren">(</span><em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/locopy/snowflake.html#combine_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#locopy.snowflake.combine_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="docutils literal notranslate"><span class="pre">copy_options</span></code> or <code class="docutils literal notranslate"><span class="pre">format_options</span></code> attribute with spaces in between and as
a string. If options is <code class="docutils literal notranslate"><span class="pre">None</span></code> then return an empty string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of strings which is to be converted into a single string with spaces
inbetween. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal notranslate"><span class="pre">options</span></code> attribute with spaces in between</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="locopy.utility.html" class="btn btn-neutral float-right" title="locopy.utility module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="locopy.s3.html" class="btn btn-neutral" title="locopy.s3 module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Capital One Services, LLC

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>